(this.webpackJsonpumagine=this.webpackJsonpumagine||[]).push([[29],{330:function(e,t,a){"use strict";a.r(t);var n=a(78),o=a(31),i=a(17),c=a(60),r=a(2),l=a(24),s=a(72),d=(a(33),a(63),a(64),a(66),a(67),a(68),a(328)),u=a(331),j=a(131),b=a(132),m=a(5),v=Object(r.lazy)((function(){return Promise.all([a.e(2),a.e(31)]).then(a.bind(null,129))})),O=Object(r.lazy)((function(){return Promise.all([a.e(2),a.e(27)]).then(a.bind(null,130))}));t.default=function(){var e,t=Object(s.a)(l.a.firestore().collection("storeCategory")),a=Object(c.a)(t,3),g=a[0],h=(a[1],a[2],Object(s.a)(l.a.firestore().collection("store"))),x=Object(c.a)(h,3),f=x[0],_=x[1],p=(x[2],Object(r.useState)({category:[]})),y=Object(c.a)(p,2),C=y[0],k=y[1],N=Object(r.useState)({}),S=Object(c.a)(N,2),F=S[0],w=S[1],L=Object(r.useState)(!1),D=Object(c.a)(L,2),B=D[0],G=D[1],q=Object(r.useState)(!1),T=Object(c.a)(q,2),U=T[0],E=T[1],I=function(e){switch(e.target.name){case"store_name":k(Object(i.a)(Object(i.a)({},C),{},{name:e.target.value}));break;case"floor_option":k(Object(i.a)(Object(i.a)({},C),{},Object(o.a)({},e.target.name,e.target.value)));break;case"store_img":k(Object(i.a)(Object(i.a)({},C),{},{image_url:e.target.files[0]}));break;case"store_num":k(Object(i.a)(Object(i.a)({},C),{},{contact_detail:e.target.value}));break;case"store_timing":k(Object(i.a)(Object(i.a)({},C),{},{timing:e.target.value}));break;case"store_desc":k(Object(i.a)(Object(i.a)({},C),{},{description:e.target.value}));break;case"store_category":var t=Object(n.a)(null===C||void 0===C?void 0:C.category);if(e.target.checked)k(Object(i.a)(Object(i.a)({},C),{},{category:[].concat(Object(n.a)(t),[e.target.value])}));else{var a=t.indexOf(e.target.value);console.log(a),t.splice(a,1),k(Object(i.a)(Object(i.a)({},C),{},{category:Object(n.a)(t)}))}}},P=b.c().shape({store_img:b.b().required("Image is required"),store_name:b.d().required("Name is required"),store_timing:b.d().required("Timing is required"),store_desc:b.d(),store_num:b.d(),store_category:b.a().required("Please select a category"),floor_option:b.d()});return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("div",{className:"container-fluid py-5",style:{fontFamily:"Inter,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif",backgroundSize:"cover",backgroundPosition:"top center"},children:Object(m.jsxs)("div",{className:"container",children:[Object(m.jsx)(d.a,{variant:"info",className:"text-white fw-bold",onClick:function(){return E(!0)},children:"ADD CATEGORY"}),Object(m.jsx)(O,{setCat:E,showCat:U}),Object(m.jsxs)("div",{className:"row ",children:[Object(m.jsx)("h1",{children:"Store Upload Form"}),Object(m.jsx)(j.a,{initialValues:{store_img:"",store_name:"",store_timing:"",store_desc:"",store_num:"",store_category:"",floor_option:""},validationSchema:P,onSubmit:function(e,t){var a=t.resetForm,n=t.setSubmitting;n(!0),a(),n(!1)},children:function(e){var t,a=e.values,n=e.errors,o=e.touched,c=e.isValid,r=e.dirty,s=e.handleChange,j=e.handleBlur;e.isSubmitting;return Object(m.jsxs)(u.a,{onSubmit:function(e){return function(e,t){var a;t.preventDefault(),l.a.storage().ref("".concat(null===e||void 0===e?void 0:e.name,"/")).child(null===e||void 0===e||null===(a=e.image_url)||void 0===a?void 0:a.name).put(null===e||void 0===e?void 0:e.image_url).on("state_changed",(function(e){}),(function(e){console.log(e)}),(function(){var t;l.a.storage().ref("".concat(null===e||void 0===e?void 0:e.name,"/")).child(null===e||void 0===e||null===(t=e.image_url)||void 0===t?void 0:t.name).getDownloadURL().then((function(e){l.a.firestore().collection("store").add(Object(i.a)(Object(i.a)({},C),{},{image_url:e}))})).then((function(e){return alert("store added success")})).catch((function(e){console.error(e)})).finally((function(e){return k({category:[]})}))}))}(C,e)},children:[Object(m.jsxs)(u.a.Group,{children:[Object(m.jsx)(u.a.Label,{children:"Store Image/Logo"}),Object(m.jsx)(u.a.Control,{type:"file",onBlur:j,onChange:function(e){I(e),s(e)},name:"store_img",value:a.store_img,className:n.store_img&&o.store_img?"is-invalid":null}),Object(m.jsx)(u.a.Control.Feedback,{type:"invalid",children:n.store_img})]}),Object(m.jsxs)(u.a.Group,{children:[Object(m.jsx)(u.a.Label,{children:"Store Name"}),Object(m.jsx)(u.a.Control,{type:"text",onBlur:j,onChange:function(e){I(e),s(e)},name:"store_name",value:a.store_name,className:n.store_name&&o.store_name?"is-invalid":null}),Object(m.jsx)(u.a.Control.Feedback,{type:"invalid",children:n.store_name})]}),Object(m.jsxs)(u.a.Group,{children:[Object(m.jsx)(u.a.Label,{children:"Store Timing"}),Object(m.jsx)(u.a.Control,{type:"text",onBlur:j,onChange:function(e){I(e),s(e)},name:"store_timing",placeholder:"Open 11am  -  8pm",value:a.store_timing,className:n.store_timing&&o.store_timing?"is-invalid":null}),Object(m.jsx)(u.a.Control.Feedback,{type:"invalid",children:n.store_timing})]}),Object(m.jsxs)(u.a.Group,{children:[Object(m.jsx)(u.a.Label,{children:"Store Description "}),Object(m.jsx)(u.a.Control,{as:"textarea",onBlur:j,onChange:function(e){I(e),s(e)},name:"store_desc",value:a.store_desc,className:n.store_desc&&o.store_desc?"is-invalid":null}),Object(m.jsx)(u.a.Control.Feedback,{type:"invalid",children:n.store_desc})]}),Object(m.jsxs)(u.a.Group,{children:[Object(m.jsx)(u.a.Label,{children:"Store Contact Number"}),Object(m.jsx)(u.a.Control,{type:"text",onBlur:j,onChange:function(e){I(e),s(e)},name:"store_num",value:a.store_num,className:n.store_num&&o.store_num?"is-invalid":null}),Object(m.jsx)(u.a.Control.Feedback,{type:"invalid",children:n.store_num})]}),Object(m.jsxs)(u.a.Group,{children:[Object(m.jsx)(u.a.Label,{children:"Store Category"}),Object(m.jsx)("br",{}),null===g||void 0===g||null===(t=g.docs)||void 0===t?void 0:t.map((function(e){return Object(m.jsx)(u.a.Check,{inline:!0,onBlur:j,onChange:function(e){I(e),s(e)},label:null===e||void 0===e?void 0:e.data().label,name:"store_category",id:null===e||void 0===e?void 0:e.data().id,value:null===e||void 0===e?void 0:e.data().value,className:n.store_category&&o.store_category?"is-invalid":null})})),Object(m.jsx)(u.a.Control.Feedback,{type:"invalid",children:n.store_category})]}),Object(m.jsxs)("select",{class:"form-select-sm my-3","aria-label":"Default select example",onChange:function(e){I(e),s(e)},name:"floor_option",children:[Object(m.jsx)("option",{value:"ground_floor",selected:!0,children:"Ground Floor"}),Object(m.jsx)("option",{value:"first_floor",selected:!0,children:"First Floor"}),Object(m.jsx)("option",{value:"second_floor",children:"Second Floor"}),Object(m.jsx)("option",{value:"third_floor",children:"Third Floor"})]}),Object(m.jsx)("br",{}),Object(m.jsx)(d.a,{variant:"primary",type:"submit",className:r&&c?"":"disabled-btn",disabled:!(r&&c),children:"Upload"})]})}})]}),Object(m.jsxs)("div",{className:"row my-4",children:[_&&Object(m.jsx)("div",{class:"d-flex justify-content-center",children:Object(m.jsx)("div",{class:"spinner-border",role:"status",children:Object(m.jsx)("span",{class:"sr-only"})})}),null===f||void 0===f||null===(e=f.docs)||void 0===e?void 0:e.map((function(e){var t,a,n,o;return Object(m.jsx)("div",{className:"col-md-3",children:Object(m.jsxs)("div",{className:"card  text-center mb-5 ",children:[Object(m.jsx)("div",{children:Object(m.jsx)("img",{className:"card-img-top p-5",src:null===e||void 0===e||null===(t=e.data())||void 0===t?void 0:t.image_url})}),Object(m.jsx)("h4",{className:"card-title",style:{fontWeight:"600"},children:null===e||void 0===e||null===(a=e.data())||void 0===a?void 0:a.name}),Object(m.jsxs)("div",{className:"card-body",children:[Object(m.jsx)("div",{className:"card-text",children:null===e||void 0===e||null===(n=e.data())||void 0===n?void 0:n.timing}),Object(m.jsx)("span",{style:{color:"rgba(0,0,0,0.5)"},children:null===e||void 0===e||null===(o=e.data())||void 0===o?void 0:o.contact_detail})]}),Object(m.jsxs)("div",{className:"card-footer text-muted d-flex justify-content-between",children:[Object(m.jsx)(d.a,{variant:"success",onClick:function(){w(Object(i.a)(Object(i.a)({},null===e||void 0===e?void 0:e.data()),{},{id:null===e||void 0===e?void 0:e.id})),G(!0)},children:"EDIT"}),Object(m.jsx)(d.a,{variant:"danger",onClick:function(t){var a,n,o;return window.confirm("Are you sure you wish to delete this item?")&&(n=null===e||void 0===e?void 0:e.id,o=null===e||void 0===e||null===(a=e.data())||void 0===a?void 0:a.image_url,l.a.storage().refFromURL(o).delete().then((function(){console.log("Deleted")})).catch((function(e){return console.log(e)})),void l.a.firestore().collection("store").doc(n).delete())},children:"DELETE"})]})]})})}))]})]})}),Object(m.jsx)(r.Suspense,{fallback:Object(m.jsx)("div",{children:"Loading.... "}),children:Object(m.jsx)(v,{sdata:F,openHandle:function(){G(!0)},closeHandle:function(){G(!1)},show:B})})]})}}}]);